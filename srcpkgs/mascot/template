# Template file for 'mascot'
pkgname=mascot
version=0.3.2alpha230107
revision=1
build_style=cargo
hostmakedepends="pkg-config"
makedepends="libcurl-devel openssl-devel"
short_desc="Configuraiton management system"
maintainer="Jakub Pastuszek <jpastuszek@protonmail.com>"
license="GPL-3.0-or-later"
homepage="https://sr.ht/~jpastuszek/mascot/"
#distfiles="https://git.sr.ht/~jpastuszek/mascot/archive/v${version}.tar.gz"
distfiles="https://voidlinux.jpastuszek.net/distfiles/mascot-v${version}.tar.gz"
wrksrc="${pkgname}-v${version}"
checksum=185e6a45c2767f09c192cfc92c397b7f333016f23bfcd7094c297ba71ddb25d6

do_install() {
	: ${make_cmd:=cargo}

	${make_cmd} install --target ${RUST_TARGET} --root="${DESTDIR}/usr" \
		${configure_args} --path mascot-converge ${make_install_args}

	${make_cmd} install --target ${RUST_TARGET} --root="${DESTDIR}/usr" \
		${configure_args} --path mascot-cli ${make_install_args}

	rm -f "${DESTDIR}"/usr/.crates.toml
	rm -f "${DESTDIR}"/usr/.crates2.json
}

post_install() {
	vlicense LICENSES/GPL-3.0-or-later.txt
	vdoc README.md
}

mascot-cli_package() {
	short_desc="Configuraiton management system - generate configuration via CLI tools"
	pkg_install() {
		vmove usr/bin/mascot-config*
	}
}
